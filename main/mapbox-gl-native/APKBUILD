# Contributor: Bart Ribbers <bribbers@disroot.org>
# Maintainer: Bart Ribbers <bribbers@disroot.org>
pkgname=mapbox-gl-native
pkgver=1.5.0.3
pkgrel=0
_commit="0d63f5661ed15d43fbbf0462d82c85e634a2e8d7"
_commit_mapbox="974c87bd9cc25b7f0a2fc31adcc51df4db694270"
pkgdesc="Mapbox GL Native"
url="https://github.com/rinigus/pkg-mapbox-gl-native"
arch="all"
license="MIT"
makedepends="qt5-qtbase-dev icu-dev"
source="pkg-$pkgname-$_commit.tar.gz::https://github.com/rinigus/pkg-mapbox-gl-native/archive/$_commit.tar.gz
	$pkgname-$_commit_mapbox.tar.gz::https://github.com/rinigus/mapbox-gl-native/archive/$_commit_mapbox.tar.gz"
options="!check"
subpackages="$pkgname-dev"
builddir="$srcdir/pkg-$pkgname-$_commit"

prepare() {
	default_prepare

	rmdir "$builddir"/mapbox-gl-native
	mv "$srcdir"/mapbox-gl-native-$_commit_mapbox "$builddir"/mapbox-gl-native
	mv "$builddir"/mapbox-gl-native-lib.pro "$builddir"/mapbox-gl-native/
}

build() {
	qmake-qt5 "CONFIG+=posix" mapbox-gl-native/mapbox-gl-native-lib.pro
	make
}

check() {
	make test
}

package() {
	INSTALL_ROOT="$pkgdir" make install
}

sha512sums="12f6554a2e787b1e398e4c3709475bc1749a92a0c912ec47f9917da866c360350f0b05c739fb0b8c58a3598e04e7ad213fd095ef3dccfef3e5e4addf16e4ce1e  pkg-mapbox-gl-native-0d63f5661ed15d43fbbf0462d82c85e634a2e8d7.tar.gz
86d50d52a2f3c8c9929e556498de6cf4cd955fd366455f533567e0d2fb35c24e03f597ea3d06821042b1ee8387c1ba23a4e3e0f70046183a84330e351251721a  mapbox-gl-native-974c87bd9cc25b7f0a2fc31adcc51df4db694270.tar.gz"
